<div class="container-fluid" data-ng-controller="ReportsCtrl as reportCtrl">
    <div class="row top-buffer">
        <div class="col-md-6">
            <h2>Reports</h2>
        </div>
        <div class="col-md-2">
            <a href="/api/report/user/24">Person test 5</a>
            <a href="/api/report/cycle/1">Cycle 1</a>
        </div>
        <div class="col-md-2">
            <div class="btn-group" role="group" aria-label="Display filter options">
                <button class="btn btn-default"
                        for="current"
                        data-ng-model="reportCtrl.displayFilter"
                        uib-btn-radio="'current'">Show Current</button>
                <button class="btn btn-default"
                        for="all"
                        data-ng-model="reportCtrl.displayFilter"
                        uib-btn-radio="'all'">Show All</button>
            </div>
        </div>
        <div class="col-md-2">
            <button class="btn btn-info" data-ng-click="reportCtrl.export()">Export Results (to CSV)</button>
        </div>
    </div>

    <div class="row top-buffer">
        <div class="col-sm-12">
            <div class="table-responsive">
                <table class="table table-hover">
                    <tbody data-ng-repeat="report in reportCtrl.reports">
                    <tr>
                        <td class="lead">Feedback for <strong>{{report.person.name}}</strong></td>
                    </tr>
                    <tr data-ng-hide="report.reviewCycle.length > 0">
                        <td>No feedback nominations</td>
                    </tr>
                    <tr data-ng-repeat="cycle in report.reviewCycle | reportDisplay: reportCtrl.displayFilter">
                        <td>
                            <table class="table table-hover">
                                <caption>Review Cycle: <strong>{{cycle.cycle.label}}</strong> <em>{{cycle.cycle.start_date | date: 'mediumDate'}} to {{cycle.cycle.end_date | date: 'mediumDate'}}</em></caption>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Colleague</th>
                                        <th>Role</th>
                                        <th>Status</th>
                                        <th>Last Updated</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr data-ng-repeat="nominee in cycle.feedback | orderBy: 'lastUpdated'">
                                        <td>{{$index + 1}}</td>
                                        <td>{{nominee.to.name}}</td>
                                        <td>{{nominee.to.role}}</td>
                                        <td>{{nominee.status}}</td>
                                        <td>
                                            <span data-ng-show="nominee.lastUpdated">{{nominee.lastUpdated | date : 'medium'}}</span>
                                            <span data-ng-hide="nominee.lastUpdated">--</span>
                                        </td>
                                        <td>
                                            <a data-ng-show="nominee.status=='Submitted' && nominee.id" href="#/detailView?id={{nominee.id}}">View</a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>